# ğŸ”§ Python-pptx æŠ€è¡“å¯¦ç¾ç´°ç¯€

## å·¥å…·é¸æ“‡èªªæ˜

æœ¬æ¬¡ PPT é‡æ–°è¨­è¨ˆé¸ç”¨ **python-pptx** çš„åŸå› ï¼š

| å·¥å…· | å„ªé» | ç¼ºé» | é©ç”¨å ´æ™¯ |
|------|------|------|--------|
| **python-pptx** âœ… | é–‹æºã€å…è²»ã€å¯ç·¨ç¨‹ã€æ”¯æŒä¸­æ–‡ | åŠŸèƒ½ä¸å¦‚ Office å®Œæ•´ | æ‰¹é‡ä¿®æ”¹ã€è‡ªå‹•åŒ–è¨­è¨ˆ |
| ChatGPT + DALLÂ·E | å¿«é€Ÿæ¦‚å¿µã€ç”Ÿæˆåœ–ç‰‡ | éœ€ä»˜è²»ã€è¼¸å‡ºç‚ºå»ºè­° | è¨­è¨ˆéˆæ„Ÿã€æ¦‚å¿µè¦–è¦º |
| PowerPoint Designer | å®˜æ–¹ã€é›†æˆåº¦é«˜ | éœ€è¦ Microsoft 365 | å–®å€‹æª”æ¡ˆå¿«é€Ÿç¾åŒ– |
| n8n + Google Slides | å¯è¦–åŒ–æµç¨‹ã€é›²ç«¯å”ä½œ | é…ç½®è¤‡é›œ | ä¼æ¥­ç´šè‡ªå‹•åŒ–å·¥ä½œæµ |

---

## å¯¦ç¾ä»£ç¢¼è©³è§£

### 1. ç’°å¢ƒæº–å‚™

```bash
# å®‰è£ä¾è³´
pip install python-pptx pillow

# å°å…¥å¿…è¦æ¨¡çµ„
from pptx import Presentation
from pptx.util import Inches, Pt
from pptx.dml.color import RGBColor
```

### 2. è®€å– PPT

```python
# åŠ è¼‰åŸå§‹æª”æ¡ˆ
prs = Presentation('åŸå§‹æª”æ¡ˆ.pptx')

# ç²å–åŸºæœ¬è³‡è¨Š
total_slides = len(prs.slides)
width = prs.slide_width.inches   # 10.0"
height = prs.slide_height.inches # 5.625"
```

**è¼¸å‡ºç¯„ä¾‹**:
```
ç¸½æŠ•å½±ç‰‡æ•¸: 25
æŠ•å½±ç‰‡å°ºå¯¸: 10.0" x 5.625" (16:9 å¯¬è¢å¹•)
```

### 3. é¢¨æ ¼ 1 å¯¦ç¾ - ç¾ä»£ç§‘æŠ€é¢¨

```python
# å®šç¾©é¡è‰²å¸¸æ•¸ (RGB æ ¼å¼)
MODERN_DARK_BG = RGBColor(20, 30, 60)      # æ·±è—èƒŒæ™¯
MODERN_ACCENT = RGBColor(100, 200, 255)   # äº®è—å¼·èª¿
MODERN_PURPLE = RGBColor(150, 100, 255)   # ç´«è‰²é»ç¶´
MODERN_WHITE = RGBColor(255, 255, 255)    # ç™½è‰²æ–‡å­—

# æ‰¹é‡ä¿®æ”¹æŠ•å½±ç‰‡
for i, slide in enumerate(prs.slides):
    # è¨­ç½®èƒŒæ™¯é¡è‰²
    background = slide.background
    fill = background.fill
    fill.solid()                           # ç´”è‰²å¡«å……
    fill.fore_color.rgb = MODERN_DARK_BG
    
    # ä¿®æ”¹æ–‡å­—æ¨£å¼
    for shape in slide.shapes:
        try:
            if hasattr(shape, "text_frame"):  # æª¢æŸ¥æ˜¯å¦æœ‰æ–‡å­—
                text_frame = shape.text_frame
                for paragraph in text_frame.paragraphs:
                    for run in paragraph.runs:
                        # è¨­å®šæ–‡å­—é¡è‰²ç‚ºç™½è‰²
                        run.font.color.rgb = MODERN_WHITE
                        
                        # å¯é¸: èª¿æ•´å­—å‹å¤§å°
                        # run.font.size = Pt(14)
                        
                        # å¯é¸: åŠ ç²—
                        # run.font.bold = True
        except Exception as e:
            pass  # è·³éç„¡æ³•è™•ç†çš„å…ƒä»¶

# ä¿å­˜æ–°æª”æ¡ˆ
prs.save('é¢¨æ ¼1_ç¾ä»£ç§‘æŠ€é¢¨.pptx')
```

**é…è‰²åŸç†**:
- **æ·±è—èƒŒæ™¯** (#141E3C): 
  - RGB: 20, 30, 60
  - æ²‰ç©©ã€ç§‘æŠ€æ„Ÿå¼·
  - è­·çœ¼ä½†ä¸æ˜æš—

- **ç™½è‰²æ–‡å­—** (#FFFFFF):
  - RGB: 255, 255, 255
  - èˆ‡æ·±è—å°æ¯”åº¦ 21:1ï¼ˆWCAG AAA ç´šï¼‰
  - æ˜“è®€æ€§æœ€é«˜

### 4. é¢¨æ ¼ 2 å¯¦ç¾ - å•†å‹™æ²‰ç©©é¢¨

```python
# å®šç¾©å•†å‹™è‰²ç³»
BUSINESS_DARK = RGBColor(45, 45, 45)       # æ·±ç°
BUSINESS_GOLD = RGBColor(184, 134, 11)    # é‡‘è‰² (#B8860B)
BUSINESS_LIGHT = RGBColor(240, 240, 240)  # æ·ºç°èƒŒæ™¯
BUSINESS_TEXT = RGBColor(60, 60, 60)      # æ·±ç°æ–‡å­—

# å‰µå»ºæ–°çš„ Presentation ç‰©ä»¶
prs_business = Presentation('åŸå§‹æª”æ¡ˆ.pptx')

for i, slide in enumerate(prs_business.slides):
    # è¨­ç½®æ·ºç°èƒŒæ™¯
    background = slide.background
    fill = background.fill
    fill.solid()
    fill.fore_color.rgb = BUSINESS_LIGHT
    
    # å·®ç•°åŒ–è™•ç†æ–‡å­—
    for j, shape in enumerate(slide.shapes):
        try:
            if hasattr(shape, "text_frame"):
                text_frame = shape.text_frame
                for paragraph in text_frame.paragraphs:
                    for run in paragraph.runs:
                        # ç¬¬ä¸€å€‹å½¢ç‹€ï¼ˆé€šå¸¸æ˜¯æ¨™é¡Œï¼‰ä½¿ç”¨é‡‘è‰²
                        if j == 0:
                            run.font.color.rgb = BUSINESS_GOLD
                            run.font.bold = True  # åŠ ç²—çªå‡º
                        # å…¶ä»–å½¢ç‹€ä½¿ç”¨æ·±ç°
                        else:
                            run.font.color.rgb = BUSINESS_TEXT
        except:
            pass

prs_business.save('é¢¨æ ¼2_å•†å‹™æ²‰ç©©é¢¨.pptx')
```

**é…è‰²åŸç†**:
- **æ·ºç°èƒŒæ™¯** (#F0F0F0):
  - RGB: 240, 240, 240
  - èƒŒæ™¯ï¼Œæ˜“æ–¼åˆ—å°
  - å‚³çµ±ã€å¯ä¿¡

- **é‡‘è‰²æ–‡å­—** (#B8860B):
  - RGB: 184, 134, 11
  - é«˜ç´šã€å°ˆæ¥­æ„Ÿ
  - ç”¨æ–¼æ¨™é¡Œçªå‡º

---

## é«˜ç´šæŠ€å·§

### æŠ€å·§ 1: é€æŠ•å½±ç‰‡å·®ç•°åŒ–è¨­è¨ˆ

```python
for i, slide in enumerate(prs.slides):
    if i == 0:  # æ¨™é¡Œé ç‰¹æ®Šè™•ç†
        # ä½¿ç”¨æ·±è‰²èƒŒæ™¯
        background = slide.background
        fill = background.fill
        fill.solid()
        fill.fore_color.rgb = RGBColor(20, 30, 60)
        
    elif i < 5:  # å‰ 5 å¼µç”¨å¼·èª¿è‰²
        background = slide.background
        fill = background.fill
        fill.solid()
        fill.fore_color.rgb = RGBColor(240, 240, 240)
        
    else:  # å…¶ä»–ç”¨æ¨™æº–èƒŒæ™¯
        background = slide.background
        fill = background.fill
        fill.solid()
        fill.fore_color.rgb = RGBColor(250, 250, 250)
```

### æŠ€å·§ 2: æ·»åŠ è‡ªå®šç¾©å­—é«”

```python
for shape in slide.shapes:
    if hasattr(shape, "text_frame"):
        for paragraph in shape.text_frame.paragraphs:
            for run in paragraph.runs:
                run.font.name = 'å¾®è»Ÿæ­£é»‘é«”'  # ä¸­æ–‡å­—é«”
                run.font.size = Pt(16)        # 16 è™Ÿ
                run.font.bold = True          # åŠ ç²—
                run.font.italic = False       # ä¸æ–œé«”
```

### æŠ€å·§ 3: æ¢ä»¶åŒ–ä¿®æ”¹

```python
# åªä¿®æ”¹åŒ…å«ç‰¹å®šé—œéµå­—çš„æ–‡å­—
for shape in slide.shapes:
    if hasattr(shape, "text"):
        if "æ¨™é¡Œ" in shape.text:
            # å°æ¨™é¡Œé€²è¡Œç‰¹æ®Šæ ¼å¼åŒ–
            for paragraph in shape.text_frame.paragraphs:
                for run in paragraph.runs:
                    run.font.size = Pt(28)
                    run.font.bold = True
```

---

## æ€§èƒ½æœ€ä½³åŒ–

### å„ªåŒ– 1: æ‰¹é‡è™•ç†

```python
# âŒ ä¸å¥½: é€å€‹ä¿å­˜
for style in styles:
    prs = Presentation('æª”æ¡ˆ.pptx')
    modify_prs(prs, style)
    prs.save(f'{style}.pptx')  # é‡è¤‡è®€å¯«

# âœ… å¥½: ä¸€æ¬¡æ€§è®€å–ï¼Œå¤šæ¬¡ä¿®æ”¹ä¿å­˜
prs_original = Presentation('æª”æ¡ˆ.pptx')

for style in styles:
    prs = Presentation('æª”æ¡ˆ.pptx')  # æ¯æ¬¡æ–°å»ºå‰¯æœ¬
    apply_style(prs, style)
    prs.save(f'{style}.pptx')
```

### å„ªåŒ– 2: ç•°å¸¸è™•ç†

```python
# å®‰å…¨çš„ä¿®æ”¹
for shape in slide.shapes:
    try:
        if hasattr(shape, "text_frame"):
            text_frame = shape.text_frame
            # ... ä¿®æ”¹ä»£ç¢¼ ...
    except AttributeError:
        pass  # è©²å½¢ç‹€ä¸æ”¯æŒæ­¤æ“ä½œ
    except Exception as e:
        print(f"è­¦å‘Š: {str(e)}")
        continue
```

---

## å¸¸è¦‹å•é¡Œæ’é™¤

### å•é¡Œ 1: ä¸­æ–‡é¡¯ç¤ºäº‚ç¢¼

```python
# âŒ å•é¡Œä»£ç¢¼
print(f"æŠ•å½±ç‰‡ {i+1}")  # åœ¨æŸäº›ç’°å¢ƒä¸­å¯èƒ½äº‚ç¢¼

# âœ… è§£æ±ºæ–¹æ¡ˆ
import sys
sys.stdout.reconfigure(encoding='utf-8')
print(f"æŠ•å½±ç‰‡ {i+1}")
```

### å•é¡Œ 2: åœ–ç‰‡ç„¡æ³•ä¿å­˜

```python
# âŒ åœ–ç‰‡è·¯å¾‘éŒ¯èª¤
picture = slide.shapes.add_picture('image.png', ...)

# âœ… ä½¿ç”¨çµ•å°è·¯å¾‘
import os
img_path = os.path.abspath('image.png')
picture = slide.shapes.add_picture(img_path, ...)
```

### å•é¡Œ 3: æ–‡å­—é¡è‰²æœªæ›´æ–°

```python
# âš ï¸ æ³¨æ„: text_frame å¯èƒ½æœ‰å¤šå±¤çµæ§‹
for paragraph in text_frame.paragraphs:
    for run in paragraph.runs:  # å¿…é ˆéæ­· runsï¼Œä¸èƒ½ç›´æ¥è¨­ç½® paragraph
        run.font.color.rgb = RGBColor(255, 0, 0)
```

---

## è³‡æºåƒè€ƒ

- **å®˜æ–¹æ–‡æª”**: https://python-pptx.readthedocs.io/en/latest/
- **RGB è‰²ç¢¼**: https://www.w3schools.com/colors/colors_rgb.asp
- **å­—é«”åç¨±** (Windows): æ§åˆ¶å° > å­—å‹ > è¤‡è£½ç¢ºåˆ‡åç¨±

---

## ç‰ˆæœ¬è³‡è¨Š

- Python: 3.12.8
- python-pptx: 0.6.21
- pillow: 10.1.0

---

